<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Tarjeta Especial</title>

<link href="https://fonts.googleapis.com/css2?family=Dancing+Script:wght@700&display=swap" rel="stylesheet">
<script src="https://unpkg.com/typed.js@2.1.0/dist/typed.umd.js"></script>

<style>
:root {
    --crimson: #dc143c;
    --crimson-soft: rgba(220, 20, 60, 0.6);
}

body {
    margin: 0;
    height: 100svh;
    display: flex;
    justify-content: center;
    align-items: center;
    background: radial-gradient(circle at center, #0a0a0a, #000);
    font-family: 'Segoe UI', sans-serif;
    overflow: hidden;
}

/* Glow ambiental */
body::before {
    content: "";
    position: absolute;
    width: 500px;
    height: 500px;
    background: radial-gradient(circle, var(--crimson-soft), transparent 70%);
    filter: blur(80px);
    opacity: 0.5;
    animation: floatGlow 12s ease-in-out infinite alternate;
}

@keyframes floatGlow {
    from { transform: translate(-40px, -20px); }
    to   { transform: translate(40px, 20px); }
}

/* Tarjeta */
.card {
    background: rgba(5,5,5,0.85);
    border-radius: 20px;
    padding: 40px 30px;
    width: min(90%, 600px);
    box-shadow: 0 0 40px rgba(220,20,60,0.15);
    backdrop-filter: blur(6px);
}

/* Pantallas */
.pantalla {
    display: none;
    flex-direction: column;
    align-items: center;
    text-align: center;
}

.activa {
    display: flex;
}

/* Bot贸n */
.btn-neon {
    background: transparent;
    border: 2px solid var(--crimson);
    color: white;
    padding: 14px 34px;
    font-size: 1.05rem;
    border-radius: 12px;
    cursor: pointer;
    letter-spacing: 1px;
    text-transform: uppercase;
    text-shadow: 0 0 6px var(--crimson);
    box-shadow: 0 0 14px var(--crimson-soft);
    transition: 0.4s;
}

.btn-neon:hover {
    background: var(--crimson);
    box-shadow: 0 0 35px var(--crimson);
}

/* Texto */
.Presentacion,
#typed {
    font-family: 'Dancing Script', cursive;
    font-size: 1.9rem;
    line-height: 1.6;
    color: #fff;
    text-shadow:
        0 0 6px var(--crimson),
        0 0 16px var(--crimson-soft);
}

/* Texto peque帽o */
.texto-pequeno {
    font-size: 0.65em;
}

/* Flicker */
.flicker {
    text-shadow:
        0 0 4px var(--crimson),
        0 0 12px var(--crimson-soft);
}

/* Texto desapareciendo */
.fade-out {
    animation: textFade 1.5s ease forwards;
}

@keyframes textFade {
    to {
        opacity: 0;
        transform: translateY(-10px);
    }
}

/* Bot贸n oculto (NO ocupa espacio) */
.btn-hidden {
    display: none;
}

/* Bot贸n visible con animaci贸n */
.btn-show {
    display: inline-block;
    animation: fadeUp 1.2s ease forwards;
}

@keyframes fadeUp {
    from {
        opacity: 0;
        transform: translateY(10px);
    }
    to {
        opacity: 1;
        transform: translateY(0);
    }
}
</style>
</head>

<body>

<div class="card">

    <!-- Pantalla 1 -->
    <div id="pantalla1" class="pantalla activa">
        <button class="btn-neon" onclick="cambiarPantalla(2)">
            Abrir carta
        </button>
    </div>

    <!-- Pantalla 2 -->
    <div id="pantalla2" class="pantalla">
        <p class="Presentacion">
            Este es un mensaje especial para Gaby.
        </p>
        <button class="btn-neon" onclick="iniciarMensaje()">
            Leer mensaje
        </button>
    </div>

    <!-- Pantalla 3 -->
    <div id="pantalla3" class="pantalla">
        <div id="typed"></div>

        <button id="btnRepetir" class="btn-neon btn-hidden" onclick="repetirMensaje()">
            Repetir mensaje
        </button>
    </div>

</div>

<script>
let typedInstance = null;
const btnRepetir = document.getElementById("btnRepetir");
const typedEl = document.getElementById("typed");

function cambiarPantalla(n) {
    document.querySelectorAll('.pantalla').forEach(p => p.classList.remove('activa'));
    document.getElementById('pantalla' + n).classList.add('activa');
}

function flickerEffect(el) {
    setTimeout(() => {
        el.classList.add("flicker");
        setTimeout(() => {
            el.classList.remove("flicker");
            flickerEffect(el);
        }, 120);
    }, 3500);
}

function iniciarMensaje() {
    cambiarPantalla(3);

    btnRepetir.className = "btn-neon btn-hidden";
    typedEl.style.display = "block";
    typedEl.classList.remove("fade-out");
    typedEl.innerHTML = "";

    if (typedInstance) {
        typedInstance.destroy();
    }

    typedInstance = new Typed('#typed', {
        strings: [
            'Solo pasaba por aqui para decirte...^1000',
            'El dia de hoy te ves muy bonita  <br><span class="texto-pequeno">(no importa cuando leas esto)</span>^1000',
            'Y me encanta cuando sonries^1000',
            'Espero que tengas un lindo d铆a 猴^1000'
        ],
        typeSpeed: 45,
        onBegin: () => flickerEffect(typedEl),
        onComplete: cierreFinal
    });
}

function cierreFinal() {
    setTimeout(() => {
        typedEl.classList.add("fade-out");

        setTimeout(() => {
            typedEl.style.display = "none";
            btnRepetir.classList.remove("btn-hidden");
            btnRepetir.classList.add("btn-show");
        }, 1500);

    }, 1000);
}

function repetirMensaje() {
    iniciarMensaje();
}
</script>

</body>
</html>
